[![Logo](https://nextpay.org/nx/assets/media/logos/logo-letter-1.png)](https://nextpay.org/nx/docs-inquiry#)

# درگاه پرداخت نکست پی

# مستندات وب سرویس های استعلامی

## مقدمه

کسب و کارهای اینترنتی به دلیل ماهیت آنها و ارتباط از راه دور، همواره با خطراتی مانند خریداران متخلف ، وجوه سرقتی از افراد قربانی و ... رو به رو هستند. از این رو
استفاده از سرویس هایی که بتواند شما را به این اطمینان برساند که خریدار، هویت مشخص و اثبات شده ای دارد، باعث میشود که در صورت بروز موارد حقوقی و قانونی، بتوانید با اطمینان
راجع به هویت خریدار اظهار نظر کنید و در مواقع لزوم از ارائه محصول به خریداران متخلف خودداری کنید.

نکست پی علاوه بر ارائه ابزار های پذیرش پرداخت های اینترنتی ، ابزار های لازم و کافی در خصوص احراز هویت از جمله سرویس های استعلامی در اختیار شما قرار میدهد تا با کمترین هزینه بتوانید مشتریان خود را به طور اتوماتیک و آنلاین احراز هویت کنید.

در این مستند قصد داریم چگونگی کار با وب سرویس های استعلامی را تشریح کنیم.

## مراحل استفاده از وب سرویس های استعلامی

پیش از استفاده از وب سرویس های استعلامی ، باید اطمینان حاصل کنید که اجازه دسترسی به این وب سرویس ها را دارید . به این منظور باید (( اشتراک زمانی )) دسترسی به وب سرویس را از داخل پنل کاربری خود در نکست پی خریداری نمایید .


سپس باید به مقدار کافی ، اعتبار استعلامی خود را شارژ کنید زیرا فراخوانی هر استعلام هزینه ای دارد که قیمت های آن در پنل کاربری و همچنین در پایین آمده است.



بنابراین برای فراخوانی وب سرویس استعلام مراحل زیر را باید طی کرده باشید.


**1- خرید اشتراک زمانی و فعالسازی دستری به وب سرویس های استعلامی**

**2- شارژ اعتبار استعلامی به میزان کافی**

**3- کپی کردن کلید inquiry\_api پس از فعالسازی اشتراک زمانی**

**4- فراخوانی وب سرویس استعلام مورد نظر به شرحی که در این مستند آمده است**

[برای دانلود نمونه درخواست استعلام های زیر برای ایمپورت در postman اینجا کلیک کنید.](https://nextpay.org/nx/inquiry.postman_collection.json.zip)

## 1- استعلام ثبت احوال : هزینه  2000   تومان

در استعلام ثبت احوال ، با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`national_id` کد ملی فرد مورد نظر
و
`birth_year`
و
`birth_month`
و
`birth_day`
که همان تاریخ تولد فرد است ، اولاً اطمینان می یابید که آیا تاریخ تولد و کد ملی صحیح است یا نه و اگر صحیح باشد ، اطلاعات فرد ، شامل نام ، نام خانوادگی ، نام پدر و وضعیت حیات او را در پاسخ دریافت خواهید کرد.
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/sabtahval`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `national_id` | کد ملی شخص مورد نظر | numeric | اجباری | `0000000000` |
| `birth_year` | سال تولد \- شمسی | numeric | اجباری | `1371` |
| `birth_month` | ماه تولد \- شمسی | numeric | اجباری | `07` |
| `birth_day` | روز تولد \- شمسی | numeric | اجباری | `19` |

## 2- استعلام شاهکار  : هزینه  1500   تومان

در استعلام

شاهکار
،

با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`national_id` کد ملی فرد مورد نظر
و
`mobile`
که همان شماره موبایل فرد است ، در پاسخ اطمینان پیدا میکنید که آیا شماره موبایل وارد شده به نام همان کد ملی در اپراتورهای تلفن همراه ثبت شده یا خیر.
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/shahkar`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `national_id` | کد ملی شخص مورد نظر | numeric | اجباری | `0000000000` |
| `mobile` | شماره موبایل | numeric | اجباری | `09120000000` |

## 3- استعلام شبا  : هزینه  400   تومان

در استعلام

شبا
،

با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`sheba`
که
همان شماره شبای مورد نظر بدون IR ابتدایی
است ، در پاسخ اطلاعاتی مانند نام فرد یا افرادی که شبا به نام آنها است و نام بانک و وضعیت حساب و نوع سپرده را دریافت خواهید کرد

لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/sheba`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `sheba` | شماره شبای مورد نظر بدون IR | numeric | اجباری | `123412341234123412341234` |

## 4- استعلام نام صاحب کارت : هزینه  200   تومان

در استعلام

نام صاحب کارت
،

با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`card`
که
همان شماره کارت مورد نظر
است در پاسخ نام فرد صاحب کارت را مشاهده خواهید کرد.

لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/card`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `card` | شماره کارت مورد نظر | numeric | اجباری | `6219861000001234` |

## 5- استعلام تبدیل کارت به شبا و دریافت نام صاحب کارت : هزینه  400   تومان

در استعلام
تبدیل کارت به شبا و دریافت نام صاحب کارت با پاس دادن
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`card`
که همان شماره کارت مورد نظر است،
در پاسخ شماره شبای مرتبط با کارت و نام صاحب کارت را دریافت خواهید کرد.
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/fullcard`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `card` | شماره کارت مورد نظر | numeric | اجباری | `6219861000001234` |

## 6- استعلام دریافت شماره 16 رقمی مربوط به یک تراکنش خاص : هزینه  200   تومان

در این استعلام با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`trans_id`
که همان کد توکن تراکنش در نکست پی است ،
شماره 16 رقمی کارت پرداخت کننده را دریافت خواهید کرد .
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/cardtx`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `trans_id` | کد تراکنش مورد نظر | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |

## 7- استعلام دریافت نام پرداخت کننده مربوط به یک تراکنش خاص : هزینه  200   تومان

در این استعلام با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`trans_id`
که همان کد توکن تراکنش در نکست پی است ،
نام صاحب کارت پرداخت کننده را دریافت خواهید کرد .
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/nametx`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `trans_id` | کد تراکنش مورد نظر | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |

## 8- استعلام دریافت نام کامل و شماره 16 رقمی مربوط به یک تراکنش خاص : هزینه  400   تومان

در این استعلام با پاس دادن پارامتر های
`inquiry_api` همان کلید دسترسی اختصاصی شما
و
`trans_id`
که همان کد توکن تراکنش در نکست پی است ،
نام دقیق پرداخت کننده به همراه شماره 16 رقمی کارت پرداخت کننده را دریافت خواهید کرد .
لازم به ذکر است که پارامتر های مذکور باید با متد
`POST`
به اندپوینت درج شده ارسال گردد .


اندپوینت و متد :


`POST` : `https://nextpay.org/nx/inquiry/fulltx`

| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `inquiry_api` | کلید وب سرویس استعلام | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |
| `trans_id` | کد تراکنش مورد نظر | uuid | اجباری | `b11ee9c3-d23d-414e-8b6e-f2370baac97b` |

## قالب پاسخ تمامی استعلام های بالا

وقتی که هر یک از استعلام های بالا را فراخوانی میکنید در پاسخ ، در فرمت
`json`
داده های زیر را دریافت خواهید کرد.


| پارامتر | عنوان | نوع | ضرورت | مثال |
| --- | --- | --- | --- | --- |
| `code` | کد وضعیت پاسخ | numeric | اجباری | `200` |
| `error` | متن خطای احتمالی | text | اجباری | `null` |
| `data` | نتیجه استعلام | json | اجباری | `{<br>        "inq": "SABTAHVAL",<br>        "inq_desc": "fetching personal identity information from national id and birth date",<br>        "inq_id": 11197,<br>        "national_id": "1234567890",<br>        "jalali_birth": "1371-07-19",<br>        "match": true,<br>        "first_name": "پويا",<br>        "last_name": "محمدی",<br>        "father_name": "احمد",<br>        "is_alive": 1<br>    }` |
| `fee` | هزینه این استعلام \- تومان | numeric | اجباری | `2000` |
| `fee_irr` | هزینه استعلام \- ریال | numeric | اجباری | `20000` |
| `inq_balance` | اعتبار استعلامی قبل از این استعلام \- تومان | numeric | اجباری | `502000` |
| `inq_balance_irr` | اعتبار استعلامی قبل از این استعلام \- ریال | numeric | اجباری | `5020000` |

## پیوست 1- کد های وضعیت و خطا


در هنگام کار با وب سرویس ، هر درخواستی که ارسال میکنید ، در پاسخ یک کد دریافت میکنید که این کد نشان دهنده وضعیت یا خطای مربوطه است . لیست این کد ها و مفهوم آنها در زیر آمده است :



| کد | توضیح |
| --- | --- |
| `200` | فراخوانی با موفقیت انجام شده |
| `400` | یکی از پارامتر های ضروری ارسال نشده |
| `402` | اعتبار استعلامی شما کافی نیست |
| `403` | کلید inquiry\_api اشتباه است یا اینکه مدت زمانی اشتراک وب سرویس شما به پایان رسیده است |
| `503` | ارائه دهنده سرویس استعلامی پاسخگو نیست |